(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{163:function(t,a,s){"use strict";s.r(a);var n=s(2),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"_1-github-actions是什么？"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-github-actions是什么？","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.GitHub Actions是什么？")]),t._v(" "),s("p",[t._v("GitHub Actions是Github的持续集成服务，类似于Jenkins、Travis CI之类的工具，帮助开发者从Github构建、测试和部署代码，我们可以通过Github的事件机制（push等）启动workflow。")]),t._v(" "),s("p",[t._v("actions类似于脚本文件，帮助开发者构建workflow，我们可以通过Github的"),s("a",{attrs:{href:"https://github.com/marketplace?type=actions",target:"_blank",rel:"noopener noreferrer"}},[t._v("Marketplace"),s("OutboundLink")],1),t._v("查找他人贡献的actions，也可以根据自己项目自定义actions。")]),t._v(" "),s("p",[t._v("actions不仅可以用于构建和部署，还可以做其他事情，因为它就是跑在docker容器中的脚本，想做什么取决于你自己。")]),t._v(" "),s("p",[t._v("目前GitHub Actions还没有全面开放，需要我们去"),s("a",{attrs:{href:"https://github.com/features/actions/signup",target:"_blank",rel:"noopener noreferrer"}},[t._v("申请"),s("OutboundLink")],1),t._v("，等待官方审核通过，大约需要几天的时间，审核通过会收到通知，同时你会看到项目里多了一个Actions的tab。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/github_action_flutter_demo/i1.png",alt:"Actions"}})]),t._v(" "),s("h2",{attrs:{id:"_2-通过github-actions构建flutter的android应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-通过github-actions构建flutter的android应用","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.通过GitHub Actions构建Flutter的Android应用")]),t._v(" "),s("p",[t._v("首先创建一个flutter应用，我拿Android Studio默认创建的flutter项目为例，提交到github仓库（"),s("a",{attrs:{href:"https://github.com/handoing/github_action_flutter_demo",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/handoing/github_action_flutter_demo"),s("OutboundLink")],1),t._v("）")]),t._v(" "),s("p",[t._v("进入Actions如图：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/github_action_flutter_demo/i2.png",alt:"Actions"}})]),t._v(" "),s("p",[t._v("目前我们还没有创建workflow，可以直接在项目本地创建一个"),s("code",[t._v(".github/workflows")]),t._v("目录并创建build.ymal文件，把文件提交到github仓库，或直接通过github创建一个workflow，这里我们直接通过github创建workflow，点击Set up a workflow yourself，并编写yaml文件。\n关于如何编写yaml这里不做介绍，大家可以直接看"),s("a",{attrs:{href:"https://help.github.com/en/articles/workflow-syntax-for-github-actions",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("p",[t._v("如图：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/github_action_flutter_demo/i3.png",alt:"workflow"}})]),t._v(" "),s("p",[t._v("修改build.yaml")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" CI\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("push"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Test on $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" matrix.os "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" matrix.os "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("strategy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("matrix")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("os")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ubuntu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# os: [ubuntu-latest, windows-latest, macos-latest]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@v1\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/setup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("java@v1\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("java-version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'12.x'")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" subosito/flutter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action@v1\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("flutter-version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1.9.1+hotfix.4'")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("channel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stable'")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" flutter build apk\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" upload artifects\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/upload"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("artifact@master\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" flutter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("android"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" build/app/outputs/apk/release\n")])])]),s("p",[t._v("这里解释下build.yaml文件执行步骤：")]),t._v(" "),s("ul",[s("li",[t._v("我们创建了一个名为CI的workflow")]),t._v(" "),s("li",[t._v("当push代码时会触发jobs")]),t._v(" "),s("li",[t._v("创建一个test的job，设置了name及runs-on，这里用到了matrix里定义的os，目前我们只使用了ubuntu系统，我们还可以添加多个操作系统")]),t._v(" "),s("li",[t._v("通过actions/checkout拉取我们代码")]),t._v(" "),s("li",[t._v("通过actions/setup-java构建java环境")]),t._v(" "),s("li",[t._v("通过subosito/flutter-action构建flutter环境")]),t._v(" "),s("li",[t._v("通过actions/upload-artifact打包我们的指定路径的文件夹上传到artifects")])]),t._v(" "),s("p",[t._v("点击Start commit提交commit，此时会触发workflow构建，我们接着点击项目Actions会看到对应workflow正在构建，如图：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/github_action_flutter_demo/i4.png",alt:"workflow"}})]),t._v(" "),s("p",[t._v("点击CI可以查看对应的构建步骤及日志信息，如图：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/github_action_flutter_demo/i5.png",alt:"workflow"}})]),t._v(" "),s("p",[t._v("当workflow执行完毕后我们可以通过点击右上角的Artifacts下载我们上传的编译产物，如图：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/github_action_flutter_demo/i6.png",alt:"workflow"}})]),t._v(" "),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结","aria-hidden":"true"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),s("p",[t._v("Github Actions适用于Github上大部分开源项目，避免了依赖Travis CI或Circle CI等第三方CI/CD工具，给开发者提供了便利的workflow，但目前Github Actions还处于测试阶段，期待后续开放。")])])}),[],!1,null,null,null);a.default=e.exports}}]);